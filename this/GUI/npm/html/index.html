<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>.GUI</title>
<link rel="icon" href="https://res.cloudinary.com/dkwnxf6gm/image/upload/v1761276578/this.gui.npm.png" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/this.gui@latest/dist/styles.css" crossorigin="anonymous" />
</head>
<body>
<div id="root"></div>
<script src="https://cdn.jsdelivr.net/npm/react@18/umd/react.production.min.js" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/react-dom@18/umd/react-dom.production.min.js" crossorigin="anonymous"></script>
<script>
  window.process = {
    env: {
      NODE_ENV: "production"
    }
  };
</script>
<script src="https://cdn.jsdelivr.net/npm/this.gui@latest/dist/this.gui.umd.js" crossorigin="anonymous"></script>
<script>
  (function () {
    const GUI = window.GUI;
    const rootEl = document.getElementById('root');

    if (!rootEl) return;

    if (!GUI) {
      rootEl.innerHTML =
        '<div style="font-family:ui-sans-serif,system-ui;padding:24px">❌ window.GUI not found</div>';
      return;
    }

    if (typeof GUI.mount !== 'function') {
      rootEl.innerHTML =
        '<div style="font-family:ui-sans-serif,system-ui;padding:24px">❌ window.GUI exists, but GUI.mount is missing</div>';
      return;
    }

    // --- Version (best-effort) -------------------------------------------------
    const GUI_VERSION =
      GUI?.version ||
      GUI?.VERSION ||
      GUI?.__version ||
      GUI?.__VERSION__ ||
      GUI?.default?.version ||
      GUI?.default?.VERSION ||
      null;

    const CDN_VERSION = (() => {
      try {
        const urls = [];
        document.querySelectorAll('script[src]').forEach((s) => urls.push(s.src));
        document.querySelectorAll('link[href]').forEach((l) => urls.push(l.href));
        for (const url of urls) {
          const m = url.match(/\/npm\/this\.gui@([^/]+)\//);
          if (m && m[1]) return m[1];
        }
      } catch (e) {}
      return null;
    })();

    const RESOLVED_VERSION =
      GUI_VERSION || (CDN_VERSION && CDN_VERSION !== 'latest' ? CDN_VERSION : null);

    let VERSION_LABEL = RESOLVED_VERSION
      ? RESOLVED_VERSION
      : CDN_VERSION === 'latest'
        ? 'latest'
        : 'unknown';

    try {
      document.title = RESOLVED_VERSION
        ? `this.GUI v${RESOLVED_VERSION} — Runtime`
        : `this.GUI (${VERSION_LABEL}) — Runtime`;
    } catch (e) {}

    // Sidebar config
    const leftSidebarConfig = {
      initialView: 'rail',
       elements: [
                { type: 'link', props: { label: 'Home', icon: 'home', href: '../../index.html' } },
                { type: 'link', props: { label: '.GUI', icon: 'widgets', href: './index.html' } },
                { type: 'link', props: { label: 'Themes', icon: 'palette', href: './themes.html' } },
                { type: 'link', props: { label: 'Exports', icon: 'schema', href: './exports.html',}},
                { type: 'link', props: { label: 'Storybook', icon: 'auto_stories', href: 'https://neurons-me.github.io/storybook-static/' } },
                { type: 'link', props: { label: 'GitHub', icon: 'code', href: 'https://github.com/neurons-me/this.GUI' } },
                { type: 'link', props: { label: 'npm', icon: 'package_2', href: 'https://www.npmjs.com/package/this.gui' } }
              ]
    };

    // JSON spec rendered by GUI.mount
    const spec = {
      type: 'Layout',
      props: { leftSidebarConfig },
      children: [
        {
          type: 'Page',
          props: { title: 'this.GUI — Runtime' },
          children: [
            {
              type: 'Box',
              props: {
                sx: {
                  mt: 2,
                  display: 'grid',
                  gridTemplateColumns: { xs: '1fr', md: '1fr 1fr' },
                  gap: 2,
                  alignItems: 'start',
                },
              },
              children: [
                {
                  type: 'Paper',
                  props: { sx: { p: 2, borderRadius: 2 } },
                  children: [
                    {
                      type: 'Box',
                      props: { sx: { display: 'flex', justifyContent: 'center' } },
                      children: [
                        {
                          type: 'Box',
                          props: {
                            component: 'img',
                            src: 'https://res.cloudinary.com/dkwnxf6gm/image/upload/v1760629119/this.gui.neurons.me_mkapde.png',
                            alt: 'this.GUI',
                            sx: { width: 220, maxWidth: '70vw', height: 'auto', display: 'block', mb: 2 },
                          },
                        },
                      ],
                    },
                    { type: 'Typography', props: { variant: 'h4', sx: { fontWeight: 900, letterSpacing: '-0.4px' } }, children: ['.GUI'] },
                    { type: 'Text', props: { sx: { mt: 0.75, color: 'text.secondary' } }, children: ['CDN Version: ' + VERSION_LABEL] }
                  ],
                },
                {
                  type: 'CodeBlock',
                  props: {
                    title: 'spec.json',
                    language: 'json',
                    variant: 'dark',
                    showLineNumbers: true,
                    wrapLongLines: true,
                    code: '',
                  },
                },
              ],
            },
          ],
        },
      ],
    };

    // Inject JSON into the CodeBlock
    try {
      const json = JSON.stringify(spec, null, 2);
      const codeBlockNode = spec?.children?.[0]?.children?.[0]?.children?.[1];
      if (codeBlockNode && codeBlockNode.type === 'CodeBlock') {
        codeBlockNode.props.code = json;
      }
    } catch (e) {}

    try {
      GUI.mount(spec, '#root');
      console.log('[GUI] ✅ Runtime mounted via GUI.mount');
    } catch (err) {
      const msg = err && err.message ? err.message : String(err);
      rootEl.innerHTML =
        '<div style="font-family:ui-sans-serif,system-ui;padding:24px">❌ mount failed: ' +
        msg +
        '</div>';
    }
  })();
</script>
</body>
</html>
